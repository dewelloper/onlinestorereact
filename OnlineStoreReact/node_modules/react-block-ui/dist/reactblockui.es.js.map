{"version":3,"file":"reactblockui.es.js","sources":["../src/Loader.js","../src/BlockUi.js"],"sourcesContent":["import React from 'react';\r\n\r\nfunction Loader() {\r\n  return (\r\n    <div className=\"loading-indicator\">\r\n      <span className=\"loading-bullet\">&bull;</span>{' '}\r\n      <span className=\"loading-bullet\">&bull;</span>{' '}\r\n      <span className=\"loading-bullet\">&bull;</span>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Loader;\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport DefaultLoader from './Loader';\r\n\r\nconst defaultProps = {\r\n  tag: 'div',\r\n  renderChildren: true,\r\n  loader: DefaultLoader,\r\n};\r\n\r\nclass BlockUi extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.tabbedUpTop = this.tabbedUpTop.bind(this);\r\n    this.tabbedDownTop = this.tabbedDownTop.bind(this);\r\n    this.tabbedUpBottom = this.tabbedUpBottom.bind(this);\r\n    this.tabbedDownBottom = this.tabbedDownBottom.bind(this);\r\n    this.setHelper = this.setRef.bind(this, 'helper');\r\n    this.setBlocker = this.setRef.bind(this, 'blocker');\r\n    this.setTopFocus = this.setRef.bind(this, 'topFocus');\r\n    this.setContainer = this.setRef.bind(this, 'container');\r\n    this.setMessageContainer = this.setRef.bind(this, 'messageContainer');\r\n    this.handleScroll = this.handleScroll.bind(this);\r\n\r\n    this.state = { top: '50%' };\r\n  }\r\n\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    if (nextProps.blocking !== this.props.blocking) {\r\n      if (nextProps.blocking) {\r\n        // blocking started\r\n        if (this.helper && this.helper.parentNode && this.helper.parentNode.contains\r\n          && this.helper.parentNode.contains(document.activeElement)) {\r\n          this.focused = document.activeElement;\r\n          // We cannot just blur to remove focus due to IE bug so we must manually move the focus somewhere else.\r\n          // https://www.tjvantoll.com/2013/08/30/bugs-with-document-activeelement-in-internet-explorer/#blurring-the-body-switches-windows-in-ie9-and-ie10\r\n          if (this.focused && this.focused !== document.body) {\r\n            (window.setImmediate || setTimeout)(() => this.topFocus && this.topFocus.focus());\r\n          }\r\n        }\r\n      } else {\r\n        this.detachListeners();\r\n        const ae = document.activeElement;\r\n        if (this.focused && (!ae || ae === document.body || ae === this.topFocus)) {\r\n          this.focused.focus();\r\n          this.focused = null;\r\n        }\r\n      }\r\n    }\r\n    if (nextProps.keepInView && (nextProps.keepInView !== this.props.keepInView || (nextProps.blocking && nextProps.blocking !== this.props.blocking))) {\r\n      this.attachListeners();\r\n      this.keepInView(nextProps);\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.detachListeners();\r\n  }\r\n\r\n  setRef(name, ref) {\r\n    this[name] = ref;\r\n  }\r\n\r\n  attachListeners() {\r\n    window.addEventListener('scroll', this.handleScroll);\r\n  }\r\n\r\n  detachListeners() {\r\n    window.removeEventListener('scroll', this.handleScroll);\r\n  }\r\n\r\n  blockingTab(e, withShift = false) {\r\n    // eslint-disable-next-line eqeqeq\r\n    return this.props.blocking && (e.key === 'Tab' || e.keyCode === 9) && e.shiftKey == withShift;\r\n  }\r\n\r\n  tabbedUpTop(e) {\r\n    if (this.blockingTab(e)) {\r\n      this.blocker.focus();\r\n    }\r\n  }\r\n\r\n  tabbedDownTop(e) {\r\n    if (this.blockingTab(e)) {\r\n      e.preventDefault();\r\n      this.blocker.focus();\r\n    }\r\n  }\r\n\r\n  tabbedUpBottom(e) {\r\n    if (this.blockingTab(e, true)) {\r\n      this.topFocus.focus();\r\n    }\r\n  }\r\n\r\n  tabbedDownBottom(e) {\r\n    if (this.blockingTab(e, true)) {\r\n      e.preventDefault();\r\n      this.topFocus.focus();\r\n    }\r\n  }\r\n\r\n  keepInView(props = this.props) {\r\n    if (props.blocking && props.keepInView && this.container) {\r\n      const containerBounds = this.container.getBoundingClientRect();\r\n      const windowHeight = window.innerHeight;\r\n      if (containerBounds.top > windowHeight || containerBounds.bottom < 0) return;\r\n      if (containerBounds.top >= 0 && containerBounds.bottom <= windowHeight) {\r\n        if (this.state.top !== '50%') {\r\n          this.setState({ top: '50%' });\r\n        }\r\n        return;\r\n      }\r\n\r\n      const messageBoundsHeight = this.messageContainer ? this.messageContainer.getBoundingClientRect().height : 0;\r\n      let top = Math.max(Math.min(windowHeight, containerBounds.bottom) - Math.max(containerBounds.top, 0), messageBoundsHeight) / 2;\r\n      if (containerBounds.top < 0) {\r\n        top = Math.min(top - containerBounds.top, containerBounds.height - (messageBoundsHeight / 2));\r\n      }\r\n      if (this.state.top !== top) {\r\n        this.setState({top});\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  handleScroll() {\r\n    this.keepInView();\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      tag: Tag,\r\n      blocking,\r\n      className,\r\n      children,\r\n      message,\r\n      loader: Loader,\r\n      renderChildren,\r\n      keepInView,\r\n      ...attributes\r\n    } = this.props;\r\n\r\n    const classes = blocking ? `block-ui ${className}` : className;\r\n    const renderChilds = !blocking || renderChildren;\r\n\r\n    return (\r\n      <Tag {...attributes} className={classes} aria-busy={blocking} ref={this.setContainer}>\r\n        {blocking &&\r\n        <div tabIndex=\"0\" onKeyUp={this.tabbedUpTop} onKeyDown={this.tabbedDownTop} ref={this.setTopFocus} />}\r\n        {renderChilds && children}\r\n        {blocking &&\r\n        <div className=\"block-ui-container\"\r\n          tabIndex=\"0\"\r\n          ref={this.setBlocker}\r\n          onKeyUp={this.tabbedUpBottom}\r\n          onKeyDown={this.tabbedDownBottom}\r\n        >\r\n          <div className=\"block-ui-overlay\" />\r\n          <div className=\"block-ui-message-container\"\r\n            ref={this.setMessageContainer}\r\n            style={{ top: keepInView ? this.state.top : undefined }}\r\n          >\r\n            <div className=\"block-ui-message\">\r\n              {message}\r\n              {React.isValidElement(Loader) ? Loader : <Loader />}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        }\r\n        <span ref={this.setHelper} />\r\n      </Tag>\r\n    );\r\n  }\r\n}\r\n\r\nBlockUi.propTypes = {\r\n  blocking: PropTypes.bool,\r\n  children: PropTypes.node,\r\n  renderChildren: PropTypes.bool,\r\n  keepInView: PropTypes.bool,\r\n  className: PropTypes.string,\r\n  message: PropTypes.oneOfType([\r\n    PropTypes.string,\r\n    PropTypes.node,\r\n  ]),\r\n  loader: PropTypes.oneOfType([\r\n    PropTypes.string,\r\n    PropTypes.func,\r\n    PropTypes.node,\r\n  ]),\r\n  tag: PropTypes.oneOfType([\r\n    PropTypes.string,\r\n    PropTypes.func,\r\n  ]),\r\n};\r\nBlockUi.defaultProps = defaultProps;\r\n\r\nexport default BlockUi;\r\n"],"names":["Loader","defaultProps","DefaultLoader","BlockUi","props","tabbedUpTop","bind","tabbedDownTop","tabbedUpBottom","tabbedDownBottom","setHelper","setRef","setBlocker","setTopFocus","setContainer","setMessageContainer","handleScroll","state","top","nextProps","blocking","helper","parentNode","contains","document","activeElement","focused","body","window","setImmediate","setTimeout","topFocus","focus","detachListeners","ae","keepInView","attachListeners","name","ref","addEventListener","removeEventListener","e","withShift","key","keyCode","shiftKey","blockingTab","blocker","preventDefault","container","containerBounds","getBoundingClientRect","windowHeight","innerHeight","bottom","setState","messageBoundsHeight","messageContainer","height","Math","max","min","Tag","tag","className","children","message","loader","renderChildren","attributes","classes","renderChilds","undefined","isValidElement","Component"],"mappings":";;AAEA,SAASA,MAAT,GAAkB;SAEd;;MAAK,WAAU,mBAAf;;;QACQ,WAAU,gBAAhB;;KADF;OAAA;;;QAEQ,WAAU,gBAAhB;;KAFF;OAAA;;;QAGQ,WAAU,gBAAhB;;;GAJJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACCF,IAAMC,eAAe;OACd,KADc;kBAEH,IAFG;UAGXC;CAHV;;IAMMC;;;mBACQC,KAAZ,EAAmB;;;iHACXA,KADW;;UAGZC,WAAL,GAAmB,MAAKA,WAAL,CAAiBC,IAAjB,OAAnB;UACKC,aAAL,GAAqB,MAAKA,aAAL,CAAmBD,IAAnB,OAArB;UACKE,cAAL,GAAsB,MAAKA,cAAL,CAAoBF,IAApB,OAAtB;UACKG,gBAAL,GAAwB,MAAKA,gBAAL,CAAsBH,IAAtB,OAAxB;UACKI,SAAL,GAAiB,MAAKC,MAAL,CAAYL,IAAZ,QAAuB,QAAvB,CAAjB;UACKM,UAAL,GAAkB,MAAKD,MAAL,CAAYL,IAAZ,QAAuB,SAAvB,CAAlB;UACKO,WAAL,GAAmB,MAAKF,MAAL,CAAYL,IAAZ,QAAuB,UAAvB,CAAnB;UACKQ,YAAL,GAAoB,MAAKH,MAAL,CAAYL,IAAZ,QAAuB,WAAvB,CAApB;UACKS,mBAAL,GAA2B,MAAKJ,MAAL,CAAYL,IAAZ,QAAuB,kBAAvB,CAA3B;UACKU,YAAL,GAAoB,MAAKA,YAAL,CAAkBV,IAAlB,OAApB;;UAEKW,KAAL,GAAa,EAAEC,KAAK,KAAP,EAAb;;;;;;8CAIwBC,WAAW;;;UAC/BA,UAAUC,QAAV,KAAuB,KAAKhB,KAAL,CAAWgB,QAAtC,EAAgD;YAC1CD,UAAUC,QAAd,EAAwB;;cAElB,KAAKC,MAAL,IAAe,KAAKA,MAAL,CAAYC,UAA3B,IAAyC,KAAKD,MAAL,CAAYC,UAAZ,CAAuBC,QAAhE,IACC,KAAKF,MAAL,CAAYC,UAAZ,CAAuBC,QAAvB,CAAgCC,SAASC,aAAzC,CADL,EAC8D;iBACvDC,OAAL,GAAeF,SAASC,aAAxB;;;gBAGI,KAAKC,OAAL,IAAgB,KAAKA,OAAL,KAAiBF,SAASG,IAA9C,EAAoD;eACjDC,OAAOC,YAAP,IAAuBC,UAAxB,EAAoC;uBAAM,OAAKC,QAAL,IAAiB,OAAKA,QAAL,CAAcC,KAAd,EAAvB;eAApC;;;SARN,MAWO;eACAC,eAAL;cACMC,KAAKV,SAASC,aAApB;cACI,KAAKC,OAAL,KAAiB,CAACQ,EAAD,IAAOA,OAAOV,SAASG,IAAvB,IAA+BO,OAAO,KAAKH,QAA5D,CAAJ,EAA2E;iBACpEL,OAAL,CAAaM,KAAb;iBACKN,OAAL,GAAe,IAAf;;;;UAIFP,UAAUgB,UAAV,KAAyBhB,UAAUgB,UAAV,KAAyB,KAAK/B,KAAL,CAAW+B,UAApC,IAAmDhB,UAAUC,QAAV,IAAsBD,UAAUC,QAAV,KAAuB,KAAKhB,KAAL,CAAWgB,QAApI,CAAJ,EAAoJ;aAC7IgB,eAAL;aACKD,UAAL,CAAgBhB,SAAhB;;;;;2CAImB;WAChBc,eAAL;;;;2BAGKI,MAAMC,KAAK;WACXD,IAAL,IAAaC,GAAb;;;;sCAGgB;aACTC,gBAAP,CAAwB,QAAxB,EAAkC,KAAKvB,YAAvC;;;;sCAGgB;aACTwB,mBAAP,CAA2B,QAA3B,EAAqC,KAAKxB,YAA1C;;;;gCAGUyB,GAAsB;UAAnBC,SAAmB,uEAAP,KAAO;;;aAEzB,KAAKtC,KAAL,CAAWgB,QAAX,KAAwBqB,EAAEE,GAAF,KAAU,KAAV,IAAmBF,EAAEG,OAAF,KAAc,CAAzD,KAA+DH,EAAEI,QAAF,IAAcH,SAApF;;;;gCAGUD,GAAG;UACT,KAAKK,WAAL,CAAiBL,CAAjB,CAAJ,EAAyB;aAClBM,OAAL,CAAaf,KAAb;;;;;kCAIUS,GAAG;UACX,KAAKK,WAAL,CAAiBL,CAAjB,CAAJ,EAAyB;UACrBO,cAAF;aACKD,OAAL,CAAaf,KAAb;;;;;mCAIWS,GAAG;UACZ,KAAKK,WAAL,CAAiBL,CAAjB,EAAoB,IAApB,CAAJ,EAA+B;aACxBV,QAAL,CAAcC,KAAd;;;;;qCAIaS,GAAG;UACd,KAAKK,WAAL,CAAiBL,CAAjB,EAAoB,IAApB,CAAJ,EAA+B;UAC3BO,cAAF;aACKjB,QAAL,CAAcC,KAAd;;;;;iCAI2B;UAApB5B,KAAoB,uEAAZ,KAAKA,KAAO;;UACzBA,MAAMgB,QAAN,IAAkBhB,MAAM+B,UAAxB,IAAsC,KAAKc,SAA/C,EAA0D;YAClDC,kBAAkB,KAAKD,SAAL,CAAeE,qBAAf,EAAxB;YACMC,eAAexB,OAAOyB,WAA5B;YACIH,gBAAgBhC,GAAhB,GAAsBkC,YAAtB,IAAsCF,gBAAgBI,MAAhB,GAAyB,CAAnE,EAAsE;YAClEJ,gBAAgBhC,GAAhB,IAAuB,CAAvB,IAA4BgC,gBAAgBI,MAAhB,IAA0BF,YAA1D,EAAwE;cAClE,KAAKnC,KAAL,CAAWC,GAAX,KAAmB,KAAvB,EAA8B;iBACvBqC,QAAL,CAAc,EAAErC,KAAK,KAAP,EAAd;;;;;YAKEsC,sBAAsB,KAAKC,gBAAL,GAAwB,KAAKA,gBAAL,CAAsBN,qBAAtB,GAA8CO,MAAtE,GAA+E,CAA3G;YACIxC,MAAMyC,KAAKC,GAAL,CAASD,KAAKE,GAAL,CAAST,YAAT,EAAuBF,gBAAgBI,MAAvC,IAAiDK,KAAKC,GAAL,CAASV,gBAAgBhC,GAAzB,EAA8B,CAA9B,CAA1D,EAA4FsC,mBAA5F,IAAmH,CAA7H;YACIN,gBAAgBhC,GAAhB,GAAsB,CAA1B,EAA6B;gBACrByC,KAAKE,GAAL,CAAS3C,MAAMgC,gBAAgBhC,GAA/B,EAAoCgC,gBAAgBQ,MAAhB,GAA0BF,sBAAsB,CAApF,CAAN;;YAEE,KAAKvC,KAAL,CAAWC,GAAX,KAAmBA,GAAvB,EAA4B;eACrBqC,QAAL,CAAc,EAACrC,QAAD,EAAd;;;;;;mCAMS;WACRiB,UAAL;;;;6BAGO;mBAWH,KAAK/B,KAXF;UAEA0D,GAFA,UAELC,GAFK;UAGL3C,QAHK,UAGLA,QAHK;UAIL4C,SAJK,UAILA,SAJK;UAKLC,QALK,UAKLA,QALK;UAMLC,OANK,UAMLA,OANK;UAOGlE,SAPH,UAOLmE,MAPK;UAQLC,cARK,UAQLA,cARK;UASLjC,UATK,UASLA,UATK;UAUFkC,UAVE;;;UAaDC,UAAUlD,yBAAuB4C,SAAvB,GAAqCA,SAArD;UACMO,eAAe,CAACnD,QAAD,IAAagD,cAAlC;;aAGE;WAAA;qBAASC,UAAT,IAAqB,WAAWC,OAAhC,EAAyC,aAAWlD,QAApD,EAA8D,KAAK,KAAKN,YAAxE;oBAEE,6BAAK,UAAS,GAAd,EAAkB,SAAS,KAAKT,WAAhC,EAA6C,WAAW,KAAKE,aAA7D,EAA4E,KAAK,KAAKM,WAAtF,GAFF;wBAGmBoD,QAHnB;oBAKE;;YAAK,WAAU,oBAAf;sBACW,GADX;iBAEO,KAAKrD,UAFZ;qBAGW,KAAKJ,cAHhB;uBAIa,KAAKC;;uCAEX,WAAU,kBAAf,GANF;;;cAOO,WAAU,4BAAf;mBACO,KAAKM,mBADZ;qBAES,EAAEG,KAAKiB,aAAa,KAAKlB,KAAL,CAAWC,GAAxB,GAA8BsD,SAArC;;;;gBAEF,WAAU,kBAAf;qBAAA;oBAESC,cAAN,CAAqBzE,SAArB,IAA+BA,SAA/B,GAAwC,oBAACA,SAAD;;;SAlBjD;sCAuBQ,KAAK,KAAKU,SAAhB;OAxBJ;;;;EA1IkBgE;;AA4LtBvE,UAAQF,YAAR,GAAuBA,YAAvB;;;;"}